{% extends "base.html" %}
{% load static %}

{% block title %}ยื่นคำขอเป็นผู้ฝึก • Train My Dog{% endblock %}
{% block body_class %}no-footer{% endblock %}

{% block extra_head %}
<style>
  body.no-footer footer { display: none !important; }

  /* ระยะกันชนด้านบนและล่าง */
  .safe-space {
    padding-top: 2.5rem;   /* ลดจาก 4rem → 2.5rem (ใกล้ navbar มากขึ้น) */
    padding-bottom: 4rem;  /* ยังเว้นล่างพอดี */
  }

  @media (min-width: 768px) {
    .safe-space {
      padding-top: 3rem;   /* สำหรับจอใหญ่ */
      padding-bottom: 5rem;
    }
  }

  /* สไตล์ input */
  input, select, textarea {
    border-radius: 0.75rem !important;
    border-color: #cbd5e1 !important;
  }
  input:focus, select:focus, textarea:focus {
    outline: none !important;
    border-color: #6366f1 !important;
    box-shadow: 0 0 0 2px rgba(99,102,241,0.3);
  }
</style>
{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto px-4 safe-space">
  <!-- ชิดซ้ายและใกล้ navbar มากขึ้น -->
  <h1 class="text-3xl font-bold mb-6 text-slate-800">ยื่นคำขอเป็นผู้ฝึก</h1>

  {% if block_resubmit and block_message %}
    <div class="mb-5 px-4 py-3 rounded-xl border border-amber-300 bg-amber-50 text-amber-800 shadow-sm leading-relaxed break-words relative z-10">
      {{ block_message }}
    </div>
  {% endif %}

  {% if messages %}
    <div class="space-y-3 mb-5 relative z-10">
      {% for message in messages %}
        <div class="px-4 py-3 rounded-xl border shadow-sm leading-relaxed break-words
                    {% if 'success' in message.tags %}border-green-300 bg-green-50 text-green-700
                    {% elif 'warning' in message.tags or 'info' in message.tags %}border-amber-300 bg-amber-50 text-amber-800
                    {% else %}border-red-300 bg-red-50 text-red-700{% endif %}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {# ===== ฟอร์มการ์ดหลัก ===== #}
  <form method="post" enctype="multipart/form-data"
        class="bg-white rounded-2xl shadow-lg ring-1 ring-slate-200 p-6 md:p-8 space-y-6 relative z-0 mt-3">
    {% csrf_token %}

    <fieldset {% if block_resubmit %}disabled{% endif %} class="space-y-5">
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">ชื่อ-นามสกุล</label>
        {{ form.full_name }}
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
        <div>
          <label class="block text-sm font-semibold text-slate-700 mb-1">อายุ</label>
          {{ form.age }}
        </div>
        <div>
          <label class="block text-sm font-semibold text-slate-700 mb-1">เพศ</label>
          {{ form.gender }}
        </div>
      </div>

      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">เบอร์โทร</label>
        {{ form.phone }}
      </div>

      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">อีเมล</label>
        {{ form.email_snapshot }}
      </div>

      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">แนะนำตัว/เพิ่มเติม</label>
        {{ form.intro }}
      </div>

      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">ลิงก์ผลงาน (ถ้ามี)</label>
        {{ form.portfolio_link }}
      </div>

      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">แนบไฟล์เกียรติบัตร/ผลงาน (ไฟล์เดียว)</label>
        {{ form.certificate }}
        <p class="text-xs text-slate-500 mt-1">รองรับ PDF หรือรูปภาพ 1 ไฟล์</p>
      </div>
    </fieldset>

    <div class="flex items-center gap-4 pt-3 mt-6">
      <a href="{% url 'trainmydog:home' %}"
        class="px-5 py-2.5 rounded-xl border border-slate-300 hover:bg-slate-50 transition">
        ยกเลิก
      </a>

      <button
        class="px-5 py-2.5 rounded-xl font-medium text-white shadow-sm transition
              {% if block_resubmit %}bg-slate-400 cursor-not-allowed{% else %}bg-indigo-600 hover:bg-indigo-500{% endif %}"
        {% if block_resubmit %}disabled aria-disabled="true"{% endif %}>
        ส่งคำขอ
      </button>
    </div>
  </form>

  {% if latest %}
    <div class="mt-6 text-sm text-slate-600">
      สถานะคำขอล่าสุดของคุณ: <b>{{ latest.get_status_display }}</b>
    </div>
  {% endif %}
</div>
{% endblock %}
